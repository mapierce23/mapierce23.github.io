<!DOCTYPE html>
<meta charset="utf-8">

<font size="5">  
    This is my assignemnt 
</font> 

<!--Load d3js. Version number matters here!-->
<script src="https://d3js.org/d3.v6.js"></script>

<!--Create a div where the graph will appear.-->
<div id="chart"></div>

<script>
const margin = {top: 10, right: 30, bottom: 30, left:60}
const width = 460 - margin.left - margin.right
const height = 400 - margin.top - margin.bottom

// Append the SVG to the body of the page
const svg = d3.select("#chart")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left}, ${margin.top})`)

d3.csv("WHR_2016.csv", function(d) {
    return {
        health: +d['Health (Life Expectancy)'],
        happiness_score: +d["Happiness Score"], 
        region: d["Region"], 
        generosity: +d["Generosity"]
    }
}).then(function(data) {
    console.log(data)
    
    // Adding an x-scale
    const x = d3.scaleLinear()
                .domain([0, d3.max(data, d=> d.health)])
                .range([0, width])
    
    const y = d3.scaleLinear()
                .domain([0, d3.max(data, d=> d.happiness_score)])
                .range([height, 0])
    
    const color = d3.scaleOrdinal()
                    .domain(data.map(d=>d.region))
                    .range(d3.schemeSet3)
    
    const size = d3.scaleLinear()
                    .domain([0, d3.max(data, d=>d.generosity)])
                    .range([1, 10])
    
    svg.append("g")
        .attr("transform", `translate(0, ${height})`)
        .call(d3.axisBottom(x))
    
    svg.append("g")
        .call(d3.axisLeft(y))
    
    // Add in our marks
    svg.append("g")
        .selectAll("dot")
        .data(data)
        .join("circle")
            .attr("cx", function(d) {
                return x(d.health);
            })
            .attr("cy", function(d) {
                return y(d.happiness_score)
            })
            //.attr("r", 3)
            .attr("r", function(d) {return size(d.generosity)})
            //.style("fill", "blue")
            .style("fill", function(d) {return color(d.region)})
})
</script>
